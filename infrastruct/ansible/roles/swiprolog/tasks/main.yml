---
# Install SWI-Prolog and janus-swi for Python-Prolog integration
# This is optional - controlled by swiprolog_enabled variable

- name: Skip SWI-Prolog installation if disabled
  meta: end_play
  when: not swiprolog_enabled

- name: Add SWI-Prolog PPA repository
  apt_repository:
    repo: ppa:swi-prolog/stable
    state: present
  become: true

- name: Install SWI-Prolog
  apt:
    name: swi-prolog
    state: present
    update_cache: yes
  become: true

- name: Install Python development headers (required for janus-swi)
  apt:
    name:
      - python3-dev
      - python3-pip
    state: present
  become: true

- name: Install janus-swi Python package (system-wide)
  pip:
    name: janus-swi
    executable: /usr/bin/pip3
  become: true

- name: Verify SWI-Prolog installation
  command: swipl --version
  register: swipl_version
  changed_when: false

- name: Verify janus-swi installation
  command: /usr/bin/python3 -c "import janus_swi; print('janus-swi OK')"
  register: janus_check
  changed_when: false

- name: Display installation status
  debug:
    msg:
      - "SWI-Prolog: {{ swipl_version.stdout }}"
      - "Janus: {{ janus_check.stdout }}"
