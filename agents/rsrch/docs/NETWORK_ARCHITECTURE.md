# Rsrch Network Architecture on halvarm

> **Auto-generated**: 2026-01-22T01:10:10+01:00
> **Generated by**: `generate-network-docs.sh`

## Quick Reference

| Service | Port | Status |
|---------|------|--------|
| **rsrch API** | `3030` | ⚠️ Check |
| **Chrome CDP** | `9221` | ✅ Connected |
| **VNC** | `5900` | ✅ Running |
| **FalkorDB** | `6379` | ✅ OK |

## Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           halvarm SERVER                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌──────────────────────┐         ┌──────────────────────────────────┐ │
│   │  rsrch-prod          │         │  Authenticated Chrome            │ │
│   │  (--network host)    │   CDP   │  (Long-running, VNC visible)     │ │
│   │                      │◄───────►│                                  │ │
│   │  Port 3030 (API)     │ :9221  │  - Google authenticated         │ │
│   │                      │         │  - Gemini PRO access             │ │
│   └──────────────────────┘         └──────────────────────────────────┘ │
│            ▲                                      ▲                      │
│            │                                      │ x11vnc               │
│   ┌────────┴────────┐              ┌──────────────┴───────────────────┐ │
│   │  FalkorDB       │              │  VNC Server                      │ │
│   │  Port 6379      │              │  Port 5900                        │ │
│   └─────────────────┘              └──────────────────────────────────┘ │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

## Live Container Status

```
rsrch-prod                     Up 14 minutes  
rsrch-manual-test-headless-v2  Up 17 hours    3000/tcp, 0.0.0.0:3038->3001/tcp, [::]:3038->3001/tcp
rsrch-manual-test-headless     Up 17 hours    3000/tcp, 0.0.0.0:3037->3001/tcp, [::]:3037->3001/tcp
rsrch-manual-test-xvfb         Up 17 hours    3000/tcp, 0.0.0.0:3036->3001/tcp, [::]:3036->3001/tcp
rsrch-manual-test-3035         Up 17 hours    3000/tcp, 0.0.0.0:3035->3001/tcp, [::]:3035->3001/tcp
```

## Chrome CDP Details

```json
{
   "Browser": "Chrome/124.0.6367.78",
   "Protocol-Version": "1.3",
   "User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36",
   "V8-Version": "12.4.254.14",
   "WebKit-Version": "537.36 (@a087f2dd364ddd58b9c016ef1bf563d2bc138711)",
   "webSocketDebuggerUrl": "ws://localhost:9221/devtools/browser/5e31f0be-5c39-42b0-92ff-88d6bcccee1f"
}
```

## rsrch API Health

```json
{"status":"warn","uptime":845.30688662,"version":"1.0.35","dependencies":{"falkordb":"ok","browser":"warn"}}
```

## Starting rsrch-prod (Reference)

```bash
# CORRECT: Connect to existing authenticated browser
docker run -d --name rsrch-prod --network host \
  -e PORT=3030 \
  -e BROWSER_CDP_ENDPOINT=http://localhost:9221 \
  -v /home/sim/.rsrch/profiles:/opt/rsrch/profiles \
  ghcr.io/simik394/osobni_wf/rsrch:vnc node dist/cli.js serve
```

## All Listening Ports

```
[::]:111 
[::]:2181 
[::]:22 
[::]:3000 
[::]:3002 
[::]:3003 
[::]:3035 
[::]:3036 
[::]:3037 
[::]:3038 
[::]:5001 
[::]:5432 
[::]:5900 
[::]:5901 
[::]:6099 
[::]:6379 
[::]:8123 
[::]:9000 
[::]:9001 
[::]:9090 
```

## Troubleshooting

| Symptom | Cause | Fix |
|---------|-------|-----|
| "Browser not initialized" | rsrch not connected to CDP | Restart with `BROWSER_CDP_ENDPOINT` |
| "Gemini requires authentication" | New browser launched | Use existing Chrome on 9221 |
| VNC shows nothing | Xvfb not running | Check display processes |
| Port 3030 in use | Old container running | `docker stop rsrch-prod` |

---
*Regenerate this file: `./generate-network-docs.sh halvarm`*
