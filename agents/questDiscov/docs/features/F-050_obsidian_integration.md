# F-050: Obsidian PKM Integration

> **Status**: Draft  
> **Priority**: High  
> **Source**: Vision Doc §6.1.3

## Problem

The research question system needs a user-friendly frontend. Researchers already use Personal Knowledge Management (PKM) tools for notes. We should integrate, not replace.

## Solution

Integrate with **Obsidian** as the primary human interface, using its Local REST API and native features.

### Why Obsidian

- Markdown-based (easy to parse/generate)
- Graph visualization built-in
- Plugin ecosystem (Dataview, Smart Connections)
- Local-first (privacy, speed)
- Cross-platform

## Technical Design

### Connection: Local REST API

```typescript
interface ObsidianClient {
  // Read operations
  getNote(path: string): Promise<NoteContent>;
  searchNotes(query: string): Promise<SearchResult[]>;
  getVaultStructure(): Promise<FolderTree>;
  
  // Write operations
  createNote(path: string, content: string): Promise<void>;
  updateNote(path: string, content: string): Promise<void>;
  appendToNote(path: string, content: string): Promise<void>;
  
  // Metadata
  getMetadata(path: string): Promise<FrontMatter>;
  updateMetadata(path: string, data: FrontMatter): Promise<void>;
}
```

### Bidirectional Sync

```
Obsidian Vault ←─────────────────────────→ Knowledge Graph (F-001)
     │                                              │
     │  1. Watch for file changes                   │
     │  2. Extract entities/relationships           │
     │  3. Update graph                             │
     │                                              │
     │  4. Priority pipeline generates questions    │
     │  5. Write to Research_Priorities.md          │
     │  6. User marks as answered                   │
     │  7. Update graph, trigger re-prioritization  │
     │                                              │
```

### Key Files

| File | Purpose |
|------|---------|
| `Research_Priorities.md` | Top priority questions (auto-updated) |
| `Knowledge_Gaps.md` | Identified gaps in knowledge graph |
| `Research_Log.md` | Append-only log of research activities |
| `Hypothesis_Registry.md` | Dataview-queryable hypothesis index |

### Auto-Generated Content Format

```markdown
---
type: research-priority
generated: 2024-12-19T10:30:00Z
priority_score: 0.847
---

# Research Priorities

> [!NOTE]
> Auto-generated by questDiscov system. Updated every hour.

## Top 5 Questions

### 1. Does compound X remain stable above 400°C?
- **Priority Score**: 0.847
- **Entropy**: 0.65 (high uncertainty)
- **Criticality**: 0.89 (blocks 12 downstream tasks)
- **Suggested Method**: DSC/TGA analysis
- **Related Notes**: [[Compound X Synthesis]], [[Thermal Stability]]

### 2. What is the synthesis yield from route B?
...
```

### Plugins Used

| Plugin | Purpose |
|--------|---------|
| **Local REST API** | External access to vault |
| **Dataview** | Query metadata across notes |
| **Smart Connections** | Semantic search within vault |
| **Tasks** | Track question completion |
| **Templater** | Templates for research notes |

## Module: `obsidian-sync.ts`

```typescript
interface SyncConfig {
  vaultPath: string;
  apiPort: number;
  apiToken: string;
  priorityFile: string;
  watchInterval: number;  // ms
}

/**
 * Start watching Obsidian vault for changes.
 */
function startVaultWatcher(config: SyncConfig): Watcher;

/**
 * Push priority questions to Obsidian.
 */
async function pushPriorities(
  questions: PrioritizedQuestion[],
  config: SyncConfig
): Promise<void>;

/**
 * Extract entities from changed notes.
 */
async function processNoteChange(
  notePath: string,
  changeType: 'create' | 'modify' | 'delete'
): Promise<EntityUpdate[]>;
```

## Use Cases

### Morning Research Review

1. Open Obsidian
2. See `Research_Priorities.md` updated overnight
3. Work on top question
4. Write findings in new note
5. Mark question completed
6. System re-prioritizes

### Knowledge Gap Discovery

Dataview query: `table from #hypothesis where status = "unverified"`

### Cross-Reference Research

Smart Connections finds semantically related notes user might have forgotten.

## Integration Points

- **F-001**: Bidirectional sync with knowledge graph
- **F-002**: Entity extraction from notes
- **F-023**: Priority output destination
- **F-051**: n8n can trigger Obsidian updates

## Verification

1. Create test note, verify graph sync
2. Generate priorities, verify Obsidian update
3. Mark question answered, verify graph update
4. Test with 100+ notes vault

## Effort Estimate

- **Development**: 3-4 days
- **Dependencies**: Local REST API plugin, F-001, F-023
